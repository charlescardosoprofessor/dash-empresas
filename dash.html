<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Econômico - Nova Porteirinha</title>
    
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { background-color: #fdfdfb; font-family: 'Inter', sans-serif; color: #404961; }
        
        /* Paleta */
        .text-dark { color: #404961; }
        .text-terra { color: #804533; }
        .text-gold { color: #dba14d; }
        .text-olive { color: #535438; }
        .bg-beige-light { background-color: #f4f1ea; } /* Variação mais clara do #dbcbb1 */
        
        .card { 
            background-color: white;
            border: 1px solid #dbcbb1;
            transition: all 0.3s ease; 
        }
        .card:hover { 
            transform: translateY(-4px); 
            box-shadow: 0 10px 15px -3px rgba(64, 73, 97, 0.1); 
            border-color: #dba14d;
        }
        
        .btn-back {
            background-color: #dbcbb1;
            color: #404961;
            transition: 0.2s;
        }
        .btn-back:hover {
            background-color: #dba14d;
            color: white;
        }
    </style>
</head>
<body>

    <div id="app" class="min-h-screen p-6 md:p-10 max-w-7xl mx-auto">
        
        <a href="index.html" class="btn-back inline-flex items-center px-4 py-2 rounded-lg text-sm font-bold mb-6">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
            Voltar ao Início
        </a>

        <header class="mb-10 text-center bg-[#404961] text-[#dbcbb1] p-8 rounded-2xl shadow-lg border-b-4 border-[#804533]">
            <h1 class="text-3xl md:text-4xl font-extrabold text-white mb-2">Painel de Desenvolvimento Econômico</h1>
            <p class="text-[#dba14d] text-lg font-medium">Nova Porteirinha/MG</p>
            <div class="mt-4 flex justify-center">
                <span class="bg-[#535438] text-white px-4 py-1 rounded-full text-xs font-bold uppercase tracking-wider border border-[#dbcbb1]">
                    População Base: {{ formatNumber(population) }} habitantes
                </span>
            </div>
        </header>

        <div class="mb-10">
            <h2 class="text-xl font-bold text-[#404961] mb-4 flex items-center">
                <span class="bg-[#dba14d] w-2 h-6 mr-3 rounded-full"></span>
                Projeção de Impacto Econômico (Anual)
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="card p-6 rounded-xl shadow-md relative overflow-hidden group">
                    <div class="absolute top-0 left-0 w-1 h-full bg-[#804533]"></div>
                    <div class="relative z-10">
                        <div class="text-[#535438] text-xs font-bold uppercase tracking-wider mb-1">Injeção Econômica Total</div>
                        <div class="text-3xl font-extrabold text-[#804533]">R$ 60 Milhões</div>
                        <div class="text-sm text-[#404961] mt-2 font-medium border-t border-[#dbcbb1] pt-2 inline-block">Investimentos + Massa Salarial</div>
                    </div>
                </div>

                <div class="card p-6 rounded-xl shadow-md relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-1 h-full bg-[#dba14d]"></div>
                    <div class="text-[#535438] text-xs font-bold uppercase tracking-wider">Massa Salarial Estimada</div>
                    <div class="text-3xl font-bold text-[#404961] mt-2">R$ 30 Milhões<span class="text-sm font-normal text-gray-400">/ano</span></div>
                    <div class="text-xs text-[#804533] mt-2 font-semibold">
                        ~1.200 Empregos Diretos
                    </div>
                </div>

                <div class="card p-6 rounded-xl shadow-md relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-1 h-full bg-[#535438]"></div>
                    <div class="text-[#535438] text-xs font-bold uppercase tracking-wider">Incremento no PIB</div>
                    <div class="text-3xl font-bold text-[#404961] mt-2">50% <span class="text-lg text-gray-400 font-normal">do PIB Atual</span></div>
                    <div class="text-xs text-[#535438] mt-2 font-semibold">
                        Impacto na arrecadação
                    </div>
                </div>
            </div>
        </div>

        <h2 class="text-xl font-bold text-[#404961] mb-4 flex items-center">
            <span class="bg-[#804533] w-2 h-6 mr-3 rounded-full"></span>
            Indicadores do Cadastro Empresarial
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">
            
            <div class="card p-6 rounded-xl shadow-sm">
                <div class="text-[#535438] text-xs font-bold uppercase">Investimento Captado</div>
                <div class="text-2xl font-bold text-[#404961] mt-2">{{ formatCurrency(totalInvestment) }}</div>
                <div class="text-xs text-[#dba14d] font-bold mt-1">
                    {{ companies.length }} empresas cadastradas
                </div>
            </div>

            <div class="card p-6 rounded-xl shadow-sm">
                <div class="text-[#535438] text-xs font-bold uppercase">Investimento Per Capita</div>
                <div class="text-2xl font-bold text-[#404961] mt-2">{{ formatCurrency(investmentPerCapita) }}</div>
                <div class="text-xs text-gray-400 mt-1">Reais por habitante</div>
            </div>

            <div class="card p-6 rounded-xl shadow-sm">
                <div class="text-[#535438] text-xs font-bold uppercase">Total de Vagas</div>
                <div class="text-2xl font-bold text-[#404961] mt-2">{{ formatNumber(totalJobs) }}</div>
                <div class="text-xs text-[#804533] mt-1 font-semibold">Diretos: {{ formatNumber(totalDirectJobs) }} | Indiretos: {{ formatNumber(totalIndirectJobs) }}</div>
            </div>

            <div class="card p-6 rounded-xl shadow-sm">
                <div class="text-[#535438] text-xs font-bold uppercase">Vagas Per Capita</div>
                <div class="text-2xl font-bold text-[#404961] mt-2">{{ formatDecimal(jobsPerCapita) }}</div>
                <div class="text-xs text-gray-400 mt-1">Vagas por habitante</div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-10">
            <div class="bg-white p-6 rounded-xl shadow-md border border-[#dbcbb1]">
                <h3 class="text-lg font-bold text-[#404961] mb-6 border-b border-[#dbcbb1] pb-2">Top 5 Maiores Investimentos</h3>
                <div class="relative h-64">
                    <canvas id="investmentChart"></canvas>
                </div>
            </div>

            <div class="bg-white p-6 rounded-xl shadow-md border border-[#dbcbb1]">
                <h3 class="text-lg font-bold text-[#404961] mb-6 border-b border-[#dbcbb1] pb-2">Geração de Empregos (Top 5)</h3>
                <div class="relative h-64 flex justify-center">
                    <canvas id="jobsChart"></canvas>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-xl shadow-md overflow-hidden border border-[#dbcbb1]">
            <div class="px-6 py-4 border-b border-[#dbcbb1] bg-beige-light">
                <h3 class="text-lg font-bold text-[#404961]">Detalhamento por Empresa</h3>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full text-left border-collapse">
                    <thead>
                        <tr class="bg-[#fcfbf8] text-[#535438] uppercase text-xs font-bold tracking-wider border-b border-[#dbcbb1]">
                            <th class="py-4 px-6">Empresa</th>
                            <th class="py-4 px-6">Descrição</th>
                            <th class="py-4 px-6 text-right">Investimento (R$)</th>
                            <th class="py-4 px-6 text-center">Vagas</th>
                        </tr>
                    </thead>
                    <tbody class="text-[#404961] text-sm font-medium">
                        <tr v-for="(company, index) in sortedCompanies" :key="index" class="border-b border-[#dbcbb1] hover:bg-[#f4f1ea] transition-colors">
                            <td class="py-4 px-6 font-bold whitespace-nowrap">{{ company.name }}</td>
                            <td class="py-4 px-6">
                                <p class="truncate w-64 text-[#535438]" :title="company.description">{{ company.description }}</p>
                            </td>
                            <td class="py-4 px-6 text-right font-bold text-[#804533]">{{ company.investment > 0 ? formatCurrency(company.investment) : '-' }}</td>
                            <td class="py-4 px-6 text-center">
                                <span class="bg-[#dbcbb1] text-[#404961] py-1 px-3 rounded-full text-xs font-bold border border-[#dba14d]">
                                    {{ company.total_jobs }}
                                </span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <footer class="mt-12 text-center text-[#535438] text-xs pb-6 border-t border-[#dbcbb1] pt-6">
            <p>Dados baseados no Cadastro de Interesse Empresarial e Projeções Econômicas Locais.</p>
        </footer>

    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    population: 6706, 
                    // Paleta para JS
                    colors: {
                        terra: '#804533',
                        gold: '#dba14d',
                        dark: '#404961',
                        beige: '#dbcbb1',
                        olive: '#535438'
                    },
                    companies: [
                        {"name": "Nova Porteirinha Empreendimentos ", "description": "Empreendimentos Imobiliários - Loteamento", "investment": 8000000.0, "direct_jobs": 30, "indirect_jobs": 100, "total_jobs": 130},
                        {"name": "Vinhedos Vale Verde", "description": "Somos uma empresa produtora de uvas de mesa.", "investment": 6000000.0, "direct_jobs": 60, "indirect_jobs": 100, "total_jobs": 160},
                        {"name": "Rede de Postos de Combustíveis Confiança ", "description": "Posto de combustíveis e serviços ", "investment": 5000000.0, "direct_jobs": 30, "indirect_jobs": 20, "total_jobs": 50},
                        {"name": "Rizzoma", "description": "Produção de mudas com com genética certificada...", "investment": 3000000.0, "direct_jobs": 50, "indirect_jobs": 300, "total_jobs": 350},
                        {"name": "Serra Geral logistica Ltda", "description": "Transporte rodoviário de cargas...", "investment": 2000000.0, "direct_jobs": 60, "indirect_jobs": 140, "total_jobs": 200},
                        {"name": "Consórcio União da Serra Geral ", "description": "Consórcio intermunicipal...", "investment": 1500000.0, "direct_jobs": 30, "indirect_jobs": 50, "total_jobs": 80},
                        {"name": "BANARICA LTDA", "description": "Produção e comercialização agropecuária...", "investment": 1200000.0, "direct_jobs": 700, "indirect_jobs": 250, "total_jobs": 950},
                        {"name": "Serra Geral Logistica Ltda (Filial)", "description": "Transporte rodoviário de cargas...", "investment": 1000000.0, "direct_jobs": 70, "indirect_jobs": 140, "total_jobs": 210},
                        {"name": "CASA DO PRODUTOR RURAL", "description": "ADUBOS, DEFENSIVOS, SEMENTES...", "investment": 700000.0, "direct_jobs": 5, "indirect_jobs": 10, "total_jobs": 15},
                        {"name": "Obregox LTDA ", "description": "Construção de casas, Galpões...", "investment": 200000.0, "direct_jobs": 20, "indirect_jobs": 100, "total_jobs": 120},
                        {"name": "NOVATUR", "description": "EMPRESA DE TRANSPORTE E TURISMO", "investment": 100000.0, "direct_jobs": 15, "indirect_jobs": 30, "total_jobs": 45},
                        {"name": "Leonardo cordeiro Souza", "description": "Geleias doces, frutas desidratadas...", "investment": 58000.0, "direct_jobs": 12, "indirect_jobs": 5, "total_jobs": 17},
                        {"name": "Pró Saúde", "description": "Hospital Dia", "investment": 0.0, "direct_jobs": 100, "indirect_jobs": 500, "total_jobs": 600},
                        {"name": "Rancho Solidão", "description": "Criação de peixes...", "investment": 0.0, "direct_jobs": 25, "indirect_jobs": 30, "total_jobs": 55},
                        {"name": "Gorutuba irrigação", "description": "Vendas e montagens...", "investment": 0.0, "direct_jobs": 6, "indirect_jobs": 15, "total_jobs": 21}
                    ]
                }
            },
            computed: {
                totalInvestment() { return this.companies.reduce((sum, item) => sum + item.investment, 0); },
                totalDirectJobs() { return this.companies.reduce((sum, item) => sum + item.direct_jobs, 0); },
                totalIndirectJobs() { return this.companies.reduce((sum, item) => sum + item.indirect_jobs, 0); },
                totalJobs() { return this.totalDirectJobs + this.totalIndirectJobs; },
                investmentPerCapita() { return this.totalInvestment / this.population; },
                jobsPerCapita() { return this.totalJobs / this.population; },
                sortedCompanies() { return [...this.companies].sort((a, b) => b.investment - a.investment); }
            },
            methods: {
                formatCurrency(value) { return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(value); },
                formatNumber(value) { return new Intl.NumberFormat('pt-BR').format(value); },
                formatDecimal(value) { return new Intl.NumberFormat('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(value); },
                renderCharts() {
                    const top5Invest = [...this.companies].sort((a, b) => b.investment - a.investment).slice(0, 5);
                    const top5Jobs = [...this.companies].sort((a, b) => b.total_jobs - a.total_jobs).slice(0, 5);

                    // Gráfico de Barras com a Paleta
                    new Chart(document.getElementById('investmentChart'), {
                        type: 'bar',
                        data: {
                            labels: top5Invest.map(c => c.name.length > 15 ? c.name.substring(0, 15) + '...' : c.name),
                            datasets: [{
                                label: 'Investimento (R$)',
                                data: top5Invest.map(c => c.investment),
                                backgroundColor: this.colors.terra, // Terracota
                                borderRadius: 4,
                                hoverBackgroundColor: this.colors.gold
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { legend: { display: false } },
                            scales: { 
                                y: { beginAtZero: true, grid: { color: this.colors.beige } }, 
                                x: { grid: { display: false } } 
                            }
                        }
                    });

                    // Gráfico de Rosca com a Paleta
                    new Chart(document.getElementById('jobsChart'), {
                        type: 'doughnut',
                        data: {
                            labels: top5Jobs.map(c => c.name.length > 15 ? c.name.substring(0, 15) + '...' : c.name),
                            datasets: [{
                                data: top5Jobs.map(c => c.total_jobs),
                                backgroundColor: [
                                    this.colors.dark,  // Azul Escuro
                                    this.colors.gold,  // Dourado
                                    this.colors.terra, // Terracota
                                    this.colors.olive, // Oliva
                                    '#a0a0a0'          // Cinza neutro para o 5º
                                ],
                                borderWidth: 2,
                                borderColor: '#ffffff'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { legend: { position: 'right', labels: { usePointStyle: true, boxWidth: 8, color: this.colors.dark } } }
                        }
                    });
                }
            },
            mounted() { this.renderCharts(); }
        }).mount('#app');
    </script>
</body>
</html>